---
repos:
  - repo: https://github.com/pre-commit/pre-commit-hooks
    rev: v6.0.0
    hooks:
      - id: check-merge-conflict
      - id: check-added-large-files
      - id: detect-private-key
      - id: check-toml
      - id: check-yaml
      - id: end-of-file-fixer
      - id: trailing-whitespace
  - repo: https://github.com/astral-sh/ruff-pre-commit
    rev: v0.14.6
    hooks:
      - id: ruff-check
        args: [--fix]
      - id: ruff-format
  - repo: https://github.com/adrienverge/yamllint.git
    rev: v1.37.1
    hooks:
      - id: yamllint
  - repo: https://github.com/pre-commit/mirrors-prettier
    rev: v4.0.0-alpha.8
    hooks:
      - id: prettier
  - repo: https://github.com/astral-sh/uv-pre-commit
    rev: 0.9.13
    hooks:
      - id: uv-lock
  - repo: https://github.com/renovatebot/pre-commit-hooks
    rev: 42.24.0
    hooks:
      - id: renovate-config-validator
  - repo: https://github.com/codespell-project/codespell
    rev: v2.4.1
    hooks:
      - id: codespell
        args: ["--toml", "pyproject.toml"]
        types: [text]
        additional_dependencies:
          - tomli
  - repo: https://github.com/igorshubovych/markdownlint-cli
    rev: v0.46.0
    hooks:
      - id: markdownlint
        files: "^docs/|^README\\.md$|^packages/recozik-webui/.*\\.md$"
        args: ["--config", ".markdownlint.json"]
  - repo: https://github.com/zricethezav/gitleaks
    rev: v8.30.0
    hooks:
      - id: gitleaks
        args: ["--redact", "--staged"]
        pass_filenames: false
  - repo: https://github.com/PyCQA/bandit
    rev: 1.9.2
    hooks:
      - id: bandit
        args:
          [
            "-lll",
            "-r",
            "packages/recozik-services",
            "packages/recozik-web",
            "src/recozik",
          ]
        exclude: "tests/"
  - repo: https://github.com/thibaudcolas/pre-commit-stylelint
    rev: v16.26.0
    hooks:
      - id: stylelint
        files: "^packages/recozik-webui/.*\\.(css|scss)$"
        args: ["--allow-empty-input", "--fix"]
        additional_dependencies:
          - stylelint@16.23.0
          - stylelint-config-standard@36.0.0
  - repo: local
    hooks:
      - id: ensure-webui-deps
        name: ensure webui deps
        entry: bash scripts/ensure_webui_deps.sh
        language: system
        pass_filenames: false
        stages: [pre-commit, manual, pre-push]
      - id: mypy
        name: mypy
        entry: uv run mypy
        language: system
        pass_filenames: false
        types: [python]
      - id: eslint-webui
        name: eslint (web UI)
        entry: >
          bash -c
          "cd packages/recozik-webui && npm run lint -- --max-warnings=0"
        language: system
        pass_filenames: false
        types_or: [javascript, jsx, ts, tsx]
ci:
  skip:
    - "uv-lock"
    - "renovate-config-validator"
    - "mypy"
    - "eslint-webui"
    - "ensure-webui-deps"
